/*! @kyobobook/kbb-js v1.0.10 (build 20231201-105226) */
"use strict";!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.__KbbJS__=e():(t.__KbbJS__=t.__KbbJS__||{},t.__KbbJS__["plugins.ui-recently-contents"]=e())}(self,(function(){return(self.webpackChunk_KbbJS_name_=self.webpackChunk_KbbJS_name_||[]).push([[399],{66281:function(t,e,n){n.r(e),n.d(e,{default:function(){return pt}});var a=n(13535),i=n.n(a),c=n(68420),l=n(27344),r=n(90306),s=n(3020),o=n(3362),u=n(69798),d=n.n(u),p=n(98882),h=n.n(p),f=n(82324),g=n(13792),_=n(89356),v=n.n(_),m=n(63263),b=n.n(m),y=n(58377),C=n.n(y),k=n(13038),Z=n.n(k),E=n(44845),w=n(5281),O=n(12088),P=n.n(O),T=n(50047),x=n.n(T),D=n(30699),S=n.n(D),L=n(51956),R=n(88066),B=n.n(R),I=n(96526),K=n(30098),j=n(42365),A=n(9185),H=n(51614),M=n.n(H);function U(t,e){var n=v()(t);if(b()){var a=b()(t);e&&(a=S()(a).call(a,(function(e){return C()(t,e).enumerable}))),n.push.apply(n,a)}return n}function N(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?U(Object(n),!0).forEach((function(e){(0,E.Z)(t,e,n[e])})):Z()?Object.defineProperties(t,Z()(n)):U(Object(n)).forEach((function(e){Object.defineProperty(t,e,C()(n,e))}))}return t}function z(t){var e=t.catg,n=t.data,a=t.type,i=t.id,c={"bg-target":".img_box"},l=null;switch(e){case A.Z.product:c=N(N({},c),{},{size:"100x0"}),"CAS"===a?P()(c,{"img-path":F(null==n?void 0:n.imgPath),url:(0,L.parseStageURL)("/BCF/post/detail/".concat(null==n?void 0:n.saleCmdtid))}):null!=n&&n.imgPath?P()(c,{pid:null==n?void 0:n.saleCmdtid,bid:null==n?void 0:n.saleCmdtid,type:"GFT","img-path":F(null==n?void 0:n.imgPath)}):P()(c,{pid:null==n?void 0:n.saleCmdtid,bid:null==n?void 0:n.cmdtcode,type:null==n?void 0:n.saleCmdtDvsnCode,adult:null==n?void 0:n.saleLmttAge}),l=(0,L.createS3ImgEl)(c);break;case A.Z.event:(0,L.isEmpty)(null==n?void 0:n.imgPath)||null==(null==n?void 0:n.imgPath)?l=(0,L.createEl)({},"img"):(c=P()(c,{"img-path":F(null==n?void 0:n.imgPath),url:(0,L.parseStageURL)("".concat("GFT"===a?"/HTR/e/".concat(i):"/EVT/detail/".concat(i)))}),l=(0,L.createS3ImgEl)(c));break;case A.Z.special:null!=(null==n?void 0:n.imgPath)?(c=P()(c,{"img-path":null==n?void 0:n.imgPath,url:(0,L.parseStageURL)("/HTR/e/".concat(i))}),l=(0,L.createS3ImgEl)(c)):l=(0,L.createEl)({},"img");break;case A.Z.brand:null!=(null==n?void 0:n.imgPath)?(c={"img-path":null==n?void 0:n.imgPath,url:(0,L.parseStageURL)("/HTR/b/".concat(i))},l=(0,L.createS3ImgEl)(c)):l=(0,L.createEl)({},"img")}return l}function F(t){var e,n;if(null!=t&&!(0,L.isEmpty)(t))return t.indexOf("http")>-1?t:M()(t).call(t,"/")?B()(e="".concat(L.CDN_HOST)).call(e,t):B()(n="".concat(L.CDN_HOST,"/")).call(n,t)}var G=n(68345);function W(t,e){var n=v()(t);if(b()){var a=b()(t);e&&(a=S()(a).call(a,(function(e){return C()(t,e).enumerable}))),n.push.apply(n,a)}return n}function J(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?W(Object(n),!0).forEach((function(e){(0,E.Z)(t,e,n[e])})):Z()?Object.defineProperties(t,Z()(n)):W(Object(n)).forEach((function(e){Object.defineProperty(t,e,C()(n,e))}))}return t}function V(t,e){var n=this,a=t.data;function i(){var e=null;switch(t.catg){case A.Z.product:if("CAS"===t.type){e=(0,I.$u)("/BCF/post/detail/".concat(null==a?void 0:a.saleCmdtid));break}e=(0,I.kR)({pid:null==a?void 0:a.saleCmdtid,bid:null!=a&&a.imgPath?null==a?void 0:a.saleCmdtid:null==a?void 0:a.cmdtcode,type:null!=a&&a.imgPath?"GFT":null==a?void 0:a.saleCmdtDvsnCode});break;case A.Z.event:e=(0,I.$u)("/EVT/detail/".concat(t.id)),"GFT"===t.type&&(e=(0,I.$u)("/HTR/e/".concat(t.id)));break;case A.Z.special:e=(0,I.$u)("/HTR/e/".concat(t.id));break;case A.Z.brand:e=(0,I.$u)("/HTR/b/".concat(t.id))}return e}function c(t){try{var e;$("div.dialog_contents .tag_wrap").children().each((function(t){$(this).hasClass("active")&&(e=$(this).children().text())})),window.ga360.GA_Event("click_공통_PC","모달",e,a.cmdtName,""),"p"===t.catg&&window.ga360.EcommerceSet("select_item",[{item_id:t.id,item_name:a.cmdtName,item_category:"종이책",item_list_name:"모달_최근본상품"}],{currency:"KRW"},{ep_ecommerce_section:"select_item>모달_최근본상품",ep_item_id:t.id,ep_item_name:a.cmdtName},{})}catch(t){}}this.cData[0].id===t.id&&this.emit("get.firstItem",{data:t});var l=(0,I.ut)("history_item","li");l.data("id",(null==a?void 0:a.saleCmdtid)||t.id);var r=(0,I.ut)("prod_area horizontal"),s=(0,I.ut)("img_box no_img","span"),o=(0,I.ut)("prod_thumb_box size_sm".concat(t.catg===A.Z.brand?" type_brand":" type_cover")).append((0,I.ut)({class:"prod_link",href:i()},"a").append(s.append(z.call(this,t))));o.on(G.C9.CLICK,(function(){c(t)}));var u=(0,I.ut)("prod_info_box size_sm"),d=(0,I.ut)({href:i(),class:"prod_info",html:'<span class="prod_name ellipsis_single">'.concat(null!=a&&a.cmdtName?null==a?void 0:a.cmdtName:"","</span>")},"a");u.on(G.C9.CLICK,(function(){c(t)}));var p=(0,I.ut)({class:"prod_period",text:null==a?void 0:a.period},"span"),h=null==a?void 0:a.saleCmdtSapr,f=null==a?void 0:a.saleCmdtPrceDscnRate,g=(0,I.ut)("prod_price","span").append([f?'<span class="percent">'.concat(f,"%</span>"):null,h?'<span class="price"><span class="val">'.concat((0,K.numberWithCommas)(h),'</span><span class="unit">원</span></span>'):null]);u.append([d,null!=a&&a.chrcName?$('<span class="prod_author">'.concat(null==a?void 0:a.chrcName,"</span>")):null,null!=a&&a.period?p:null,h||f?g:null]),r.append([o,u]);var _=(0,I.ut)("history_control_box").append([function(){var i,c=(0,I.ut)({class:B()(i="".concat(e?"btn_wish_circle size_sm":"btn_history_wish"," ")).call(i,"Y"===(null==a?void 0:a.wish)?"active":""),type:"button"},"button").append([(0,I.ut)({class:e?"ico_wish":"ico_history_wish"},"span"),(0,I.ut)({class:"hidden",text:"찜하기"},"span")]),l=J(J({},function(t){var e="001",n="001";switch(t){case L.ProductCategory.EBOOK:e="002";break;case"CAS":e="003",n="002";break;case L.ProductCategory.HOTTRACKS_DVD:case L.ProductCategory.HOTTRACKS_GIFT:case L.ProductCategory.HOTTRACKS_MUSIC_ALBUM:e="004";break;case L.ProductCategory.EBOOK_SAM:e="005";break;case L.ProductCategory.EBOOK_AUDIO:e="006";break;case L.ProductCategory.EBOOK_VIDEO:e="007";break;case L.ProductCategory.KYOBO_PB:e="008";break;case L.ProductCategory.GIFT_CARD:e="009";break;case L.ProductCategory.EBOOK_DUM:e="010";break;case L.ProductCategory.CULTURE:e="011",n="002"}return{myrmDvsnCode:e,nbopDvsnCode:n}}((null==a?void 0:a.saleCmdtDvsnCode)||t.type)),{},{nbopTrgtCttsIdnfNum:(null==a?void 0:a.saleCmdtid)||t.id});switch(t.catg){case A.Z.event:case A.Z.brand:case A.Z.special:c=null}return(0,j.w)(null==t?void 0:t.type)&&(c=null),null!=c&&c.on("click",(function(t){var e=$(t.target.closest("button"));e.hasClass("active")?n.ui.wish(!1,l,e):n.ui.wish(!0,l,e)})),c}(),(0,I.ut)({class:"btn_history_delete",type:"button"},"button").append([(0,I.ut)({class:"ico_history_del"},"span"),(0,I.ut)({class:"hidden",text:"삭제"},"span")])]);return l.append([r,_])}function Y(){this.getElement("recentCount").text(this.recentList.length),q.call(this)}function q(){var t=this,e=this.curTab.catg,n=this.ua.isMobile,a="최근 본 상품 및 콘텐츠가 없습니다";if(this.getElement("itemWrap").empty(),this.recentList.length>0){var i,c=x()(i=this.recentList).call(i,(function(e){return $(V.call(t,e,n))}));this.getElement("itemWrap").append(c)}else{switch(e){case A.Z.product:a="최근 본 상품이 없습니다";break;case A.Z.special:a="최근 본 기획전이 없습니다";break;case A.Z.event:a="최근 본 이벤트가 없습니다";break;case A.Z.brand:a="최근 본 브랜드가 없습니다"}this.getElement("itemWrap").html(function(t){return(0,I.ut)({class:"no_data"}).append((0,I.ut)({class:"no_data_desc",text:t}))}(a))}Q.call(this)}function Q(){var t,e,n,a,i=this,c=this.options.elements,l=h()(t=this.$root).call(t,null==c||null===(e=c.item)||void 0===e||null===(n=e.tag)||void 0===n?void 0:n.item);l.off("click").on("click",(function(t){var e,n=$(t.target).closest("button");if(!n.hasClass("active")){var a=n.index(),c=n.data("catg");l.removeClass("active"),n.addClass("active"),i.curTab={index:a,catg:c},0!==i.curTab.index?i.recentList=S()(e=i.cData).call(e,(function(t){return t.catg===c})):i.recentList=i.cData}})),this.setElement("tab",l),h()(a=this.$root).call(a,".btn_history_delete").on("click",(function(t){var e=$(t.target.closest(".history_item")).data("id");i.itemDelete(e)}))}var X=n(71649),tt=n(17997),et=n.n(tt);function nt(){var t=this.ua.isMobile,e=$(this.getOption("trigger"));if(null!==e){var n=e.attr("data-target").replace(/^#/,""),a=(0,L.createEl)({id:n,class:"dialog_wrap ".concat(t?"has_btn dialog_history":""),"data-class":t?"dialog_full":"dialog_history"}),i=(0,L.createEl)({type:"button",class:"btn_dialog_close","data-dialog-close":!0,html:'<span class="ico_dialog_close"></span><span class="hidden">닫기</span>'},"button");return a.append([i,at(t),it.call(this,t)],t?ct.call(this):""),$("body").append(a),a}}function at(t){return(0,L.createEl)("dialog_header").append((0,L.createEl)({class:"dialog_title",html:t?'최근 본 <span class="fc_spot">0</span>':"최근 본"}))}function it(t){var e,n=this,a=["상품|".concat(A.Z.product),"기획전|".concat(A.Z.special),"이벤트|".concat(A.Z.event),"브랜드|".concat(A.Z.brand)],i=(0,L.createEl)("dialog_contents"),c=(0,L.createEl)({class:"tag_wrap ".concat(t?"size_md":"size_lg"),"data-tag-toggle":!0}),l=(0,L.uniqBy)(this.cData,"catg"),r=x()(l).call(l,(function(t){var e,n=t.catg;return B()(e="".concat(function(t){var e="";switch(t){case A.Z.brand:e="브랜드";break;case A.Z.product:e="상품";break;case A.Z.event:e="이벤트";break;case A.Z.special:e="기획전"}return e}(n),"|")).call(e,n)}));(0,L.concat)(["전체|a"],(0,X.Z)(new(et())(B()(e=[]).call(e,(0,X.Z)(r),a)))).forEach((function(t,e){var n=t.split("|");c.append((0,L.createEl)({type:"button",class:"tag ".concat(0===e?"active":""),"data-catg":n[1],html:'<span class="text">'.concat(n[0],"</span>")},"button"))})),i.append(c);var s=(0,L.createEl)({type:"button",class:"btn_delete_text",html:'<span class="ico_delete"></span><span class="text">전체삭제</span>'},"button").on("click",(function(t){n.count>0&&n.ui.alert({title:"최근 본 전체 콘텐츠를 삭제하시겠습니까?",showCancelButton:!0}).then((function(t){t.value&&n.listAllDelete()}))})),o=(0,L.createEl)(this.isMobile?"list_result_wrap type_no_line":"sort_list_header").append([(0,L.createEl)(this.isMobile?"result_count":"sort_result_desc",this.isMobile?"p":"span").append((0,L.createEl)({html:'<span class="'.concat(this.isMobile?"fc_green":"val",'">0</span>건')},"span")),this.isMobile?"":s]);i.append(o);var u=(0,L.createEl)("history_list_wrap"),d=(0,L.createEl)("custom_scroll_wrap"),p=(0,L.createEl)("history_list","ul");return u.append(t?p:d.append(p)),i.append(u),i}function ct(){var t=this;return(0,L.createEl)("dialog_footer").append((0,L.createEl)({type:"button",class:"btn_lg btn_line_gray fw_regular",html:'<span class="ico_trash"></span><span class="text">전체 삭제</span>'},"button").on("click",(function(e){t.count>0&&t.ui.alert({title:"최근 본 전체 콘텐츠를 삭제하시겠습니까?",showCancelButton:!0}).then((function(e){e.value&&t.listAllDelete()}))})))}function lt(){var t=this,e=nt.call(this).one("dialogcreate",(function(e,n){t._dialog=$(e.target).dialog("instance"),t.init(),t.initialized=!0}));this.ui.dialog("#"+e.attr("id"))}function rt(t,e){var n=v()(t);if(b()){var a=b()(t);e&&(a=S()(a).call(a,(function(e){return C()(t,e).enumerable}))),n.push.apply(n,a)}return n}function st(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rt(Object(n),!0).forEach((function(e){(0,E.Z)(t,e,n[e])})):Z()?Object.defineProperties(t,Z()(n)):rt(Object(n)).forEach((function(e){Object.defineProperty(t,e,C()(n,e))}))}return t}function ot(t){var e=function(){if("undefined"==typeof Reflect||!i())return!1;if(i().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=(0,o.Z)(t);if(e){var c=(0,o.Z)(this).constructor;n=i()(a,arguments,c)}else n=a.apply(this,arguments);return(0,s.Z)(this,n)}}var ut=function(t){(0,r.Z)(n,t);var e=ot(n);function n(t,a,i){var l;(0,c.Z)(this,n),(l=e.call(this,t,a,i)).initOptions(),l._curTab={index:0,catg:A.Z.all},l._count=0,l._cData=[],l._data=null,l._recentList=null;var r=$(l.getOption("trigger"));if(null==r)return(0,s.Z)(l);var o=r.attr("data-target").replace(/^#/,"");return $("#".concat(o)).length>0?(0,s.Z)(l):(l.once("get.firstItem",(function(t){var e=t.data;if(!l.isMobile){var n=l.getElement("count").closest(".btn_history"),a=function(t){var e=t.catg,n=t.data,a=t.type,i=null;switch(e){case A.Z.product:var c;i="CAS"===a||null!=n&&n.imgPath?F(null==n?void 0:n.imgPath):B()(c="".concat(L.CDN_HOST,"/sih/fit-in/100x0/pdt/")).call(c,null==n?void 0:n.cmdtcode,".jpg");break;case A.Z.event:i="GFT"===a?null==n?void 0:n.imgPath:F(null==n?void 0:n.imgPath);break;case A.Z.special:case A.Z.brand:i=null==n?void 0:n.imgPath}return i}(e);if(null!=a){var i=$('[data-kbbfn="ui-recently-contents"]');return h()(i).call(i,"img").attr("src",a),void n.removeClass("no_item")}n.addClass("no_item")}})),lt.call((0,w.Z)(l)),l)}return(0,l.Z)(n,[{key:"initOptions",value:function(){P()(this.options,{elements:{root:"#popHistoryContents",recentBtn:{web:".btn_history",mobile:".btn_docker_history"},itemWrap:".history_list",item:{wrap:".history_item",deleteBtn:".btn_history_delete",wish:{ink:".btn_history_wish",mok:".btn_wish_circle.size_sm"},tag:{wrap:".tag_wrap",item:".tag"}}}})}},{key:"active",get:function(){return this.$root.dialog("isOpen")},set:function(t){t!==this.active&&this.$root.dialog(t?"open":"close")}},{key:"curTab",get:function(){return this._curTab},set:function(t){var e=t.index;this._curTab=t,this.getElement("tab").removeClass("active"),this.getElement("tab").eq(e).addClass("active")}},{key:"recentList",get:function(){return this._recentList},set:function(t){var e,n,a,i,c=this,l=[];switch(this.curTab.catg){case A.Z.all:l=x()(t).call(t,(function(t){var e=t.id,n=t.type,a=t.catg,i={id:e,type:n,catg:a};switch(a){case A.Z.event:i={id:e,type:n,catg:a};break;case A.Z.brand:case A.Z.special:i={id:e,catg:a}}return i}));break;case A.Z.product:l=x()(e=S()(t).call(t,(function(t){return t.catg===A.Z.product}))).call(e,(function(t){return{id:t.id,type:t.type,catg:t.catg}}));break;case A.Z.event:l=x()(n=S()(t).call(t,(function(t){return t.catg===A.Z.event}))).call(n,(function(t){return{id:t.id,type:t.type,catg:t.catg}}));break;case A.Z.brand:l=x()(a=S()(t).call(t,(function(t){return t.catg===A.Z.brand}))).call(a,(function(t){return{id:t.id,catg:t.catg}}));break;case A.Z.special:l=x()(i=S()(t).call(t,(function(t){return t.catg===A.Z.special}))).call(i,(function(t){return{id:t.id,catg:t.catg}}))}l.length>0?j._.call(this,l).then((function(e){t=x()(t).call(t,(function(t){var n=t.id,a=h()(e).call(e,(function(t){return t.saleCmdtid===n}));return null!=a?st(st({},t),{},{data:a}):t}))})).finally((function(){c._recentList=t,Y.call(c)})):(this._recentList=t,Y.call(this))}},{key:"history",get:function(){return this.modules.get("history")}},{key:"count",get:function(){return this._count},set:function(t){this._count=t;var e=this.getElement("count"),n=this.getElement("totalCount.mok");t>0?n.show():n.hide(),e.text(t),n.text(t)}},{key:"cData",get:function(){var t=(this.history.list||[]).reverse();return x()(t).call(t,(function(t){var e=t.split("|");return{catg:e[0],type:e[1],id:e[2]}}))}},{key:"$root",get:function(){var t=this.options.elements,e=null==t?void 0:t.root;if(null!==e)return $(e)}},{key:"init",value:function(){var t,e,n,a,i,c,l=this.options.elements,r=this.ui.$body;this.setElement("count",h()(t=h()(r).call(r,".floating_wrapper .btn_history")).call(t,".count")),this.setElement("recentCount",h()(e=this.$root).call(e,this.isMobile?".result_count .fc_green":".sort_list_header .val")),this.setElement("totalCount.mok",h()(n=this.$root).call(n,".dialog_header .fc_spot")),this.setElement("itemWrap",h()(a=this.$root).call(a,null==l?void 0:l.itemWrap)),this.setElement("item",h()(i=this.$root).call(i,null==l||null===(c=l.item)||void 0===c?void 0:c.wrap)),this.count=this.cData.length,this.recentList=this.cData}},{key:"listAllDelete",value:function(){null==this.history.list||this.history.clear(),this._cData=[],this.recentList=[],this.count=0}},{key:"itemDelete",value:function(t){var e,n=S()(e=this.recentList).call(e,(function(e){return e.id!==t.toString()}));this.recentList=n,this.count=this.count-1,this.history.remove(t.toString())}}]),n}(L.UiPluginsModuleItem);function dt(t){var e=function(){if("undefined"==typeof Reflect||!i())return!1;if(i().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=(0,o.Z)(t);if(e){var c=(0,o.Z)(this).constructor;n=i()(a,arguments,c)}else n=a.apply(this,arguments);return(0,s.Z)(this,n)}}var pt=new(function(t){(0,r.Z)(n,t);var e=dt(n);function n(){var t;return(0,c.Z)(this,n),(t=e.call(this,"recently-contents"))._list=[],t}return(0,l.Z)(n,[{key:"list",get:function(){return this._list}},{key:"history",get:function(){return this.modules.get("history")}},{key:"addItem",value:function(t){var e=t.catg,n=t.type,a=t.id;this.history.put(e,n,a)}},{key:"createDialog",value:function(t){var e=this;if(!this.initialized)return this.ready((function(){return e.createDialog(t)}));var n=(0,g.U2)(t,"trigger");if(null==n)return d().reject(new Error("[".concat(n,"] undefined trigger element selector!")));if(!(0,g.HD)(n)){var a="trigger_"+this.list.length;$(n).data("kbbfn-sid",a),n=a}var i=this.getInstance(n);if(null!=i)return d().resolve(i);var c=new ut(this,n,t);return this.list.push(c),d().resolve(c)}},{key:"exists",value:function(t){return null!=this.getInstance(t)}},{key:"getInstance",value:function(t){var e;return h()(e=this.list).call(e,(function(e){return e.id===t}))}}]),n}(f.YZ))}},function(t){return t.O(0,[321,160,712],(function(){return e=66281,t(t.s=e);var e})),t.O()}])}));