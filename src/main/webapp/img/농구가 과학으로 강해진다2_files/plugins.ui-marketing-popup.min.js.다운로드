/*! @kyobobook/kbb-js v1.0.10 (build 20231201-105226) */
"use strict";!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.__KbbJS__=e():(t.__KbbJS__=t.__KbbJS__||{},t.__KbbJS__["plugins.ui-marketing-popup"]=e())}(self,(function(){return(self.webpackChunk_KbbJS_name_=self.webpackChunk_KbbJS_name_||[]).push([[301],{74510:function(t,e,n){n.r(e),n.d(e,{default:function(){return A}});var i=n(13535),r=n.n(i),a=n(33938),u=n(68420),o=n(27344),s=n(90306),c=n(3020),l=n(3362),p=n(63109),h=n.n(p),f=n(69798),d=n.n(f),g=n(98882),v=n.n(g),_=n(51956),m=n(5281),y=n(12088),b=n.n(y),k=n(82324),S=n(96526);function P(){var t=(0,S.ut)({id:"popMarketingAgree",class:"dialog_wrap marketing_agree"}).append(B);return $("body").append(t),t}function B(){return[(0,S.ut)("dialog_contents").append(['<h1 class="hidden">마케팅 수신동의</h1>',(0,S.ut)("title_wrap title_size_md").append('<p class="title_heading">유용한 정보와 할인혜택을 놓치지 마세요!</p>'),(0,S.ut)("marketing_agree_list","ul").append([Z("new","새로 들어온 책 / 상품 정보 알림"),Z("sale","쇼핑 혜택 및 할인정보 알림"),Z("culture","다양한 문화생활 정보 알림")])]),(0,S.ut)("dialog_footer").append([(0,S.ut)({class:"btn_md btn_light_gray",id:"disagreeBtn",html:'<span class="text">나중에 할게요</span>'},"button"),(0,S.ut)({class:"btn_md btn_primary",id:"agreeBtn",html:'<span class="text">동의합니다</span>'},"button")])]}function Z(t,e){return(0,S.ut)("agree_item","li").append([(0,S.ut)("ico_agree_".concat(t),"span"),(0,S.ut)("agree_info").append('<span class="info_title">'.concat(e,"</span>"))])}function x(){var t=this,e=P.call(this).one("dialogcreate",(function(e,n){t._dialog=$(e.target).dialog("instance"),t.init(),t.initialized=!0}));this.ui.dialog("#"+e.attr("id"))}function C(t){var e=function(){if("undefined"==typeof Reflect||!r())return!1;if(r().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r()(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,l.Z)(t);if(e){var a=(0,l.Z)(this).constructor;n=r()(i,arguments,a)}else n=i.apply(this,arguments);return(0,c.Z)(this,n)}}var E=function(t){(0,s.Z)(n,t);var e=C(n);function n(t,i,r){var a;return(0,u.Z)(this,n),(a=e.call(this,t,i,r)).initOptions(),a._dialog=null,a._date="",a._pushSiteCode="001",x.call((0,m.Z)(a)),a}return(0,o.Z)(n,[{key:"initOptions",value:function(){b()(this.options,{elements:{root:"#popMarketingAgree",checkBox:"#marketingAgree01",btn:{agree:"#agreeBtn",disagree:"#disagreeBtn"}}})}},{key:"$root",get:function(){var t=this.options.elements,e=null==t?void 0:t.root;if(null!==e)return $(e)}},{key:"date",get:function(){var t=new Date,e=t.getFullYear(),n=t.getMonth()+1,i=t.getDate();return this._date=e+"년 "+n+"월 "+i+"일",this._date}},{key:"pushSiteCode",get:function(){return this._pushSiteCode}},{key:"dialog",get:function(){return this._dialog}},{key:"init",value:function(){this.createElement(),this.bindEvents()}},{key:"bindEvents",value:function(){var t=this;this.getElement("agreeBtn").on("click",(function(e){t.updatePush("Y")})),this.getElement("disagreeBtn").on("click",(function(e){t.updatePush("N")}))}},{key:"setMobiPushSet",value:function(t){var e={pushType:"event",pushYn:t};return this.mobi.request("setPushSettings",e)}},{key:"createElement",value:function(){var t,e,n,i,r,a=this.options.elements;this.setElement("agreeCheckBox",v()(t=this.$root).call(t,null==a?void 0:a.checkBox)),this.setElement("agreeBtn",v()(e=this.$root).call(e,null==a||null===(n=a.btn)||void 0===n?void 0:n.agree)),this.setElement("disagreeBtn",v()(i=this.$root).call(i,null==a||null===(r=a.btn)||void 0===r?void 0:r.disagree))}},{key:"updatePush",value:function(t){var e=this,n="/api".concat((0,S._7)("api.urls.myr.app.push")),i={pushRcmsAgrmYsno:t,pushRcmsPatrCode:"002",pushSiteCode:this.pushSiteCode};return this.$http(n,{method:"PUT",body:i}).then((function(n){var i="Y"===t?"마케팅 수신에 동의하셨습니다.</br>수신동의 일시 : ".concat(e.date):"마케팅 수신에 동의하지 않으셨습니다.</br>수신 미동의 일시 : ".concat(e.date);e.setMobiPushSet(t),e.dialog.close(),setTimeout((function(){e.ui.toast(i)}))}))}}]),n}(k.ht);function Y(t){var e=function(){if("undefined"==typeof Reflect||!r())return!1;if(r().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r()(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,l.Z)(t);if(e){var a=(0,l.Z)(this).constructor;n=r()(i,arguments,a)}else n=i.apply(this,arguments);return(0,c.Z)(this,n)}}var w=function(t){(0,s.Z)(i,t);var e,n=Y(i);function i(){var t;return(0,u.Z)(this,i),(t=n.call(this,"marketing-popup"))._list=[],t._eventYn="NONE",t}return(0,o.Z)(i,[{key:"list",get:function(){return this._list}},{key:"createDialog",value:function(t){var e=this;if(!this.initialized)return this.ready((function(){return e.createDialog(t)}));var n=this.getInstance("popMarketingAgree");return null!=n?d().resolve(n):new E(this,"popMarketingAgree",t).ready().then((function(t){return t.dialog.open()}))}},{key:"init",value:function(t){var e=this;this.ua.isMobileApp&&(this.on("callbackGetPushSettings",(function(n){var i=n.data;if(e._eventYn!==i.eventYn){var r={pushType:"event",pushYn:e._eventYn};return e.mobi.request("setPushSettings",r)}if("NONE"===i.eventYn)return e.createDialog(t)})),this.getAppPushConfig().then((function(t){null==t||t.forEach((function(t){"002"===t.pushRcmsPatrCode&&(e._eventYn=t.pushRcmsAgrmYsno)})),e.mobi.request("getPushSettings")})))}},{key:"getInstance",value:function(t){var e;return v()(e=this.list).call(e,(function(e){return e.id===t}))}},{key:"getAppPushConfig",value:(e=(0,a.Z)(h().mark((function t(){var e,n;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e="/api".concat((0,S._7)("api.urls.myr.app.push"))+"?pushSiteCode=001",t.next=4,this.$http(e,{method:"GET"});case 4:return n=t.sent,t.abrupt("return",n.data);case 8:t.prev=8,t.t0=t.catch(0);case 10:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return e.apply(this,arguments)})}]),i}(_.UiPluginsModule),A=new w}},function(t){return t.O(0,[321,160,712],(function(){return e=74510,t(t.s=e);var e})),t.O()}])}));